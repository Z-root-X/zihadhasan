import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
    const { pathname } = request.nextUrl;

    // Check for firebase auth session cookie (session based auth)
    // Note: Client-side Firebase Auth doesn't automatically set server-side cookies.
    // For a purely client-side app like this (SPA-style admin), we often use a client-side check.
    // HOWEVER, for "System Designer" level security, we should ideally verify on server.
    // BUT, setting up Firebase Admin SDK + Session Cookies is complex.
    // DESIGN DECISION: We will use a "Hybrid" approach.
    // Middleware here handles obvious redirects, but the real security gate is the <AuthGuard> component on the client.
    // Middleware mainly prevents flashing.

    // For now, let's just ensure we don't get stuck in loops.
    // Real authentication check happens in the layout/page via Firebase Listener.

    // If we wanted to do cookie based implementation we would look for 'connect.sid' or similar custom cookie.
    // Since we are using standard Firebase JS SDK, we will rely on Client Side Protection for now,
    // but we can add a simple "admin-token" cookie if we wanted to enforce it later.

    return NextResponse.next();
}

// See "Client-Side Auth Guard" pattern in (admin)/layout.tsx for the actual security enforcement.
export const config = {
    matcher: ['/dashboard/:path*', '/admin/:path*'],
};
